<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MIP-16: Calculation of gas fees  - MIP</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../../GLOSSARY.html">Glossary</a></li><li class="chapter-item expanded "><a href="../../../../index.html">Approved</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../index.html">MIPs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-1/index.html">MIP-1: ENTL (Enclave Nonce Time-lock)</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-15/index.html">MIP-15: MG (Movement Gloss)</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-39/index.html">MIP-39: MOVE Token -- HTLC-based Native Bridge Design</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-53/index.html">MIP-53: Conventions for Proposing Progressive L2 Models</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MDs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-1/index.html">MD-1: Minimize Risk of Compromised Bridge Key without Governance</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-3/index.html">MD-3: MCR under Network Partitions and Asynchrony</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-15/index.html">MD-15: Movement Glossary</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MGs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MG/mg-39/index.html">MG-39:  MOVE Token -- Bridge Design</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">Review</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../index.html">MIPs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/mikhail/suzuka-da-migrations/MIP/mip-13/index.html">MIP-13:  Suzuka DA Migrations Format</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MIP/mip-42/index.html">MIP-15: NB-FFS Decoupled Demurrage</a></li><li class="chapter-item expanded "><a href="../../../../Review/gas-fee-calculation/MIP/mip-16/index.html" class="active">MIP-16: Calculation of gas fees </a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mip-18/MIP/mip-18/index.html">MIP-18: Stage 0 Upgradeability and Multisigs</a></li><li class="chapter-item expanded "><a href="../../../../Review/andyjsbell/unwanted-framework/MIP/mip-24/index.html">MIP-24: Removal of redundant functionality from framework</a></li><li class="chapter-item expanded "><a href="../../../../Review/andyjsbell/proxy-root/MIP/mip-25/index.html">MIP-25: Proxy Aptos Framework for Stage 0 governance</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mip-27/MIP/mip-27/index.html">MIP-27: Contract Pipeline</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/actor-naming-conventions/MIP/mip-28/index.html">MIP-28: Naming Conventions for Movement Protocol Design</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/FFS/MIP/mip-34/index.html">MIP-34: Fast Finality Settlement</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled/MIP/mip-40/index.html">MIP-40: NB-FFS Decoupled</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-governed-gas-pool/MIP/mip-44/index.html">MIP-44: NB-FFS Governed Gas Pool</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/security_falliblity/MIP/mip-46/index.html">MIP-46: Security and Fallibility of the Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/gas-fees-incremental-additions/MIP/mip-47/index.html">MIP-47: Improve Gas fee collection in phases</a></li><li class="chapter-item expanded "><a href="../../../../Review/0xmovses/aptos-gov-pool/MIP/mip-48/index.html">MIP-48: aptos_governance for Goverened Gas Pool</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/just-reward/MIP/mip-49/index.html">MIP-49: NB-FFS Governed Fees and Rewards</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/insured-bridge/MIP/mip-50/index.html">MIP-50: Insured Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/the-biarritz-model/MIP/mip-54/index.html">MIP-54: The Biarritz Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/the-bilbao-model/MIP/mip-55/index.html">MIP-55: The Bilbao Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter/MIP/mip-56/index.html">MIP-56: Rate-Limiter for the HTLC-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer/MIP/mip-57/index.html">MIP-57: Informer for the Operation of the HTLC-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip-58/MIP/mip-58/index.html">MIP-58: Lock/Mint-type Native Bridge with trusted Relayer</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip-crosschain-bridges-background/MIP/mip-60/index.html">MIP-60: Crosschain bridge architectures</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/relayer-bootstrap-and-reboot/MIP/mip-61/index.html">MIP-61: Relayer in the lock/mint bridge - Algorithm and Bootstrapping </a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/L2confirmation/MIP/mip-65/index.html">MIP-65: FFS: Fastconfirmations</a></li><li class="chapter-item expanded "><a href="../../../../Review/issue66/MDMIP-for-bridge-fees/MIP/mip-69/index.html">MIP-69: Bridge Fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer-lockmintbridge/MIP/mip-71/index.html">MIP-71: Informer V1 for the Operation of the Lock/Mint Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/sanfran-model/MIP/mip-73/index.html">MIP-73: The SanFran Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter-lock-mint-bridge/MIP/mip-74/index.html">MIP-74: Rate limiter for the Lock/Mint-type Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mainnet-feature-flags/MIP/mip-81/index.html">MIP-81</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/lock-mint-bridge-rate-limit-basics/MIP/mip-84/index.html">MIP-84: Lock-Mint Native Bridge: Basics of Relayer trust assumptions</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MDs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/enclave-crash-resistant-keys/MD/md-2/index.html">MD-2: Enclave Crash-resistant Key Management</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/long-range-attacks/MD/md-5/index.html">MD-4: Long Range Attacks</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/gas-offset/MD/md-4/index.html">MD-4: MCR Offsetting Gas Costs</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/block-validation/MD/md-6/index.html">MD-6: Suzuka Block Validation</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/block-validation/MD/md-7/index.html">MD-7: Prevent Suzuka MEV Exploits and Censorship</a></li><li class="chapter-item expanded "><a href="../../../../Review/mikhail/suzuka-da-migrations/MD/md-13/index.html">MD-13: Suzuka DA Migrations Format</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/bridge-timelock-as-state/MD/md-14/index.html">MD-14: Bridge Should Use A More Secure Timelock</a></li><li class="chapter-item expanded "><a href="../../../../Review/andygolay/move-on-bitcoin/MD/md-16/index.html">MD-16: Create MOVE fungible asset on Bitcoin using runes</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/md-17/MD/md-17/index.html">MD-17: Bridge Fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/bridge-attestors/MD/md-21/index.html">MD-21: Native Bridge with Attesters</a></li><li class="chapter-item expanded "><a href="../../../../Review/andygolay/md-26/MD/md-26/index.html">MD-26: User-facing checks</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/md-30/MD/md-30/index.html">MD-30: Movement Name Service</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/FFS/MD/md-34/index.html">MD-34: Fast Finality Settlement</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/provisions-for-fixed-token-supply/MD/md-38/index.html">MD-38: Provide for Fixed Token Supply when Using Native Bridge and Fast Finality Settlement (FFS)</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/just-reward/MD/md-49/index.html">MD-49: Movement L2 Gas Fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/L2confirmation/MD/md-65/index.html">MD-65: FFS: Fastconfirmations</a></li><li class="chapter-item expanded "><a href="../../../../Review/issue66/MDMIP-for-bridge-fees/MD/md-69/index.html">MD-69: Bridge fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer-lockmintbridge/MD/md-71/index.html">MD-71: Informer service for the Lock/Mint-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter-lock-mint-bridge/MD/md-74/index.html">MD-74: Rate-Limiter for the Lock/Mint-type Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mainnet-feature-flags/MD/md-81/index.html">MD-81: Movement Mainnet Feature Flags</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MGs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MG/mg-42/index.html">MG-42: demurrage token</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MIP</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/movementlabsxyz/MIP-Testing" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="mip-16-calculation-of-gas-fees"><a class="header" href="#mip-16-calculation-of-gas-fees">MIP-16: Calculation of gas fees</a></h1>
<ul>
<li><strong>Description</strong>: How to calculate gas fees for transactions on Movement L2.</li>
<li><strong>Authors</strong>: <a href="mailto:franck.cassez@movementlabs.xyz">Franck Cassez</a></li>
</ul>
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>This MIP describes the structure of the gas fees and overall resource consumption needed to execute, and post a transaction to the DA/L1.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>The transaction fees on L2s are multi-dimensional [<a href="#ref-9">9</a>, <a href="#ref-10">10</a>]. They comprise of <em>execution fees</em>, <em>settlement fees</em> and <em>data availability fees</em>.
This MIP describes what the different types of fees are, and how the transaction fees can be computed.</p>
<h2 id="scope-of-this-mip"><a class="header" href="#scope-of-this-mip">Scope of this MIP</a></h2>
<p>This MIP applies to costs/fees <strong>related to executing Move bytecode</strong>.</p>
<blockquote>
<p>[!WARNING]
It does not cover the extended future framework where EVM bytecode can be executed on a Movement chain.</p>
</blockquote>
<p>Althought the costs (in terms of resources consumption) are expressed in gas units when executing Move and EVM bytecode, the gas units are <strong>not comparable</strong>, e.g. the minimum gas for an EVM transaction is 21000 gas units, whereas for Move-Aptos it is 700 gas units. As a result designing a fee mechanism for Movement chains that support Move and EVM bytecodes will require some careful adjustments and analysis of the different fee structures (Move and EVM).</p>
<blockquote>
<p>[!WARNING]
This MIP does not cover <em>staking</em> (and slashing and rewards) for validators.</p>
</blockquote>
<h2 id="fee-structure"><a class="header" href="#fee-structure">Fee structure</a></h2>
<p>The processing costs on rollups [<a href="#ref-1">1</a> - <a href="#ref-6">6</a>] are  <a href="https://medium.com/offchainlabs/understanding-arbitrum-2-dimensional-fees-fd1d582596c9">multi-dimensional</a>. The cost of processing a transaction on a Movement chain consists of:</p>
<ol>
<li><strong>execution</strong> fees: the costs that correspond to resources usage, CPU and permanent storage.</li>
<li><strong>data availability</strong> fees: the costs of publishing transactions/blocks data to a <em>data availability layer</em>.</li>
<li><strong>settlement</strong> fees: the costs of <em>validating</em> a transaction (e.g. zk-proof generation and verification, validators attestations.)</li>
</ol>
<p>Overall the transaction fees are defined by the sum of three types of fees:</p>
<p>$$ {ExecFees} + {DAFees} + {SetlFees}\mathpunct. $$</p>
<p>The fees should be expressed in a single (crypto)-currency, e.g. USD, or a token <code>$APT</code>, <code>$MOVE</code>, <code>$ETH</code>.</p>
<h3 id="execution"><a class="header" href="#execution">Execution</a></h3>
<h4 id="movevm-execution-fees"><a class="header" href="#movevm-execution-fees">MoveVM execution fees</a></h4>
<p>To execute a transaction and store the result, the operator of the chain uses some hardware: CPU and disk storage. The <strong>execution</strong> fees represent the compensation of the operator for executing a transaction.</p>
<p>Movement Network uses Aptos-Move as the execution layer and the execution fees for Aptos-Move are defined in the Aptos documentation <a href="https://aptos.dev/en/network/blockchain/gas-txn-fee">Gas and storage fees</a>.
The Aptos-Move fee mechanism splits the execution fees in two parts:</p>
<ul>
<li>CPU and IO operations, expressed in gas units;</li>
<li>permanent storage, expressed in <code>$APT</code>.</li>
</ul>
<p>CPU and IO operations for a transaction $tx$ result in a number of gas units $CpuIoGas(tx)$, and the corresponding fees are computing using a <em>gas price</em> $GasPrice$ expressed in the gas token (<code>$APT</code> for Aptos-Move). A transaction specifies the value $GasPrice(tx)$ it is willing to pay.<br />
The value $GasPrice(tx)$ must not be lower than a minimum $GasPrice$, which may fluctuate depending on network contention, and may be updated frequently (e.g. after each block).</p>
<p>In contrast, the permanent storage fees are designed to be stable and are updated infrequently. The reasoning is that they depend on how much storage costs (hardware, disks) and with advancement in technology this should go down in the future. The storage fees for $tx$ are denoted $StoreFees(tx)$ and expressed in <code>$APT</code><sup class="footnote-reference"><a href="#3">1</a></sup>.</p>
<p>The fees that correspond to the permanent storage are <strong>converted to gas units</strong> using the  $GasPrice$ and the <code>$APT</code> price.</p>
<p>The <em>total charge in gas units</em> for a transaction is the defined by:</p>
<p>$$ TotalGasUnits(tx) = CpuIoGas(tx) + StoreFees(tx)/GasPrice(tx)$$</p>
<p>and the total transaction fees are approximately<sup class="footnote-reference"><a href="#1">2</a></sup>:</p>
<p>$$ ExecFees(tx) = TotalGasUnits(tx) \times GasPrice(tx) \mathpunct.$$</p>
<blockquote>
<p>[!WARNING]
We may not use the <code>$APT</code> token value to compute the fees on Movement. If we do so the $ExecFees$ will be identical to processing fees on Aptos-Move, and the total fees including $DAFees$ and $SetlFees$ will be higher than the processing fees on Aptos-Move, which may not be desirable.</p>
</blockquote>
<blockquote>
<p>[!TIP]
<strong>Proposal 1</strong>: use the $TotalGasUnits(tx)$ and a $GasPrice$ in <code>$MOVE</code> to compute the execution fees on a Movement chain.
This may require an oracle to get the exchange rate for <code>$APT</code>/<code>$MOVE</code>.</p>
</blockquote>
<h4 id="gas-price-adjustments"><a class="header" href="#gas-price-adjustments">Gas price adjustments</a></h4>
<p>We may also want to adjust the $GasPrice$ (in <code>$MOVE</code>) to reflect our network load. There are many ways the $GasPrice$ can be updated. On Ethereum it is governed by rules in <a href="https://eips.ethereum.org/EIPS/eip-1559">EIP-1559</a>. zkSync, Arbitrum and OP Mainnet use different strategies [<a href="#ref-1">1</a>, <a href="#ref-4">4</a>, <a href="#ref-6">6</a>] to update the gas price.</p>
<blockquote>
<p>[!TIP]
<strong>Proposal 2</strong>: The OP Mainet [<a href="#ref-1">1</a>] strategy seems to be the simplest one so we may implement this strategy first.</p>
</blockquote>
<h3 id="data-availability-fees"><a class="header" href="#data-availability-fees">Data Availability fees</a></h3>
<p>On a rollup (L2), transactions are grouped in <em>batches</em>. Processing a batch result in a new <em>state</em>. Both the transactions data and the new state are published to the <em>data availability</em> (DA) layer. The reason is that they should be available for third-parties to retrieve and verify the correctness of the state transitions (and blocks).</p>
<p>We assume that the agreement with the DA provider is such that we pay a <strong>fixed</strong> amount, $DAPerBytePrice$, in USD, per bytes we publish to the DA layer.
This can be updated infrequently e.g. every 6 months or year.</p>
<blockquote>
<p>[!NOTE]
To reduce the costs, the data published to the DA layer can be compressed. This reduces the overall costs of publishing a batch (and a state) to the DA layer but makes it harder to identify the contribution of each transaction to the overall costs. OP Mainnet Ecotone has a <a href="https://docs.optimism.io/stack/transactions/fees#formula">formula</a> to try and weight the contribution of each transaction to the compressed data. It is unclear how well it works in practice.</p>
</blockquote>
<blockquote>
<p>[!TIP]
<strong>Proposal 3</strong>: If the cost of publishing a batch $b$ to the DA is $DAFees(b)$, and $n$ transactions are in the batch, the DA fees for each transaction are $DAFees(b)/n$. This is simple to implement and can be refined later if needed.</p>
</blockquote>
<h3 id="settlement-fees"><a class="header" href="#settlement-fees">Settlement Fees</a></h3>
<p>The settlement fees depend on a number of factors, and on the settlement mechanism used by a given Move Stack chain.
There is a common feature though: some data are posted to Ethereum mainnet, and the price of a transaction on Mainnet may fluctuate.</p>
<p>The difficulty is that we charge our users when we process a transaction on a Move Stack chain. At that time we don’t know the price of an Ethereum transaction to post our data because it will happen in the future when the transaction is included in a block. As a result we may have to use an oracle to provide an estimate of the (gas) price on Ethereum when our transaction is processed.</p>
<p>Another thing that is common to all the settlement mechanisms is that we have to publish a <em>commitment</em> to the states/blocks we produce.
This is usually done by publishing <em>state roots</em> (hashes of states).
There are two interfaces to publish data on Ethereum:</p>
<ul>
<li>transaction data, and</li>
<li>blobs.</li>
</ul>
<p>Blobs were introduced to lower the cost of L2s and offer temporary (18 days) data storage at low cost.
Blobs are limited in size to 128KB, and a maximum of 6 blobs per (Ethereum) block.</p>
<h4 id="fraud-proof-settlement"><a class="header" href="#fraud-proof-settlement">Fraud-proof settlement</a></h4>
<p>For a fraud-proof settlement mechanism, we have to publish the <em>state roots</em> of the blocks we produce, or the change sets (they may be smaller).<br />
The size of the state roots of change sets roots is known when we create a (l2) block, so we can determine the expected cost of publishing to Ethereum mainnet using an oracle for the Ethereum gas price.</p>
<h4 id="validity-proof-settlement"><a class="header" href="#validity-proof-settlement">Validity proof settlement</a></h4>
<p>In a validity proof settlement we have two sources of costs:</p>
<ol>
<li>the <em>proving</em> part, which is a task dedicated to provers (or a market thereof),</li>
<li>the <em>verification</em> part which is a transaction in Ethereum Mainnet.</li>
</ol>
<p>The second part is usually predicatable as the sizes of proofs are known for each zk-proof system, and the verification step is <em>efficient</em>.
The proving part is more complex to evaluate. The <a href="https://docs.zksync.io/zk-stack/concepts/fee-mechanism">zkSync –– Fee mechanism</a> [<a href="#ref-4">4</a>] may be a useful reference to design an equivalent mechanism for Movement chains.</p>
<blockquote>
<p>[!WARNING]
Note that we first need a zkMoveVM to develop this approach.</p>
</blockquote>
<h4 id="fast-finality-settlement"><a class="header" href="#fast-finality-settlement">Fast-finality settlement</a></h4>
<p>In our network, we will offer <em>fast-finality settlement</em> (FFS) where <em>validators</em> verify state transitions (and blocks) and interact with a contract, <code>StakingK</code>, that may live<sup class="footnote-reference"><a href="#2">3</a></sup> on Ethereum mainnet.</p>
<p>The costs incurred by the validators plus the cost of posting the attestations to Ethereum mainnet have to be factored in into the ${SetlFees}$.</p>
<blockquote>
<p>[!WARNING]
We have not finalised the FFS details yet so it may be premature to try and define fees for this mechanism. It also pertains to <em>staking</em> which is not fully fledged yet.</p>
</blockquote>
<blockquote>
<p>[!TIP]
<strong>Proposal 4</strong>: The simplest approach seems to implement a fraud-proof fee mechanism and publish state roots to Ethereum mainnet.</p>
</blockquote>
<h2 id="references"><a class="header" href="#references">References</a></h2>
<p><a id="ref-1">[1]</a> <a href="https://docs.optimism.io/stack/transactions/fees">Transaction fees on OP Mainnet</a>. Optimism Documentation.</p>
<p><a id="ref-2">[2]</a>   <a href="https://docs.sui.io/concepts/tokenomics/gas-pricing">Sui –– Gas Pricing</a>. Sui Documentation.</p>
<p><a id="ref-3">[3]</a>  <a href="https://aptos.dev/en/network/blockchain/gas-txn-fee">Gas and storage fees</a>. Aptos documentation.</p>
<p><a id="ref-4">[4]</a>  <a href="https://docs.zksync.io/zk-stack/concepts/fee-mechanism">zkSync –– Fee mechanism</a>. zkSync documentation.</p>
<p><a id="ref-1">[5]</a>  <a href="https://docs-v2.mantle.xyz/devs/concepts/tx-fee/overviews">Transaction fees on Mantle</a>. Mantle documentation.</p>
<p><a id="ref-6">[6]</a>   <a href="https://docs.arbitrum.io/how-arbitrum-works/gas-fees">Gas and Fees</a>. Arbitrum documentation.</p>
<!-- \[4\] Arbitrum. [L1 Pricing.](https://developer.arbitrum.io/arbos/l1-pricing)

\[5\] D. Goldman. Medium, July 1st, 2022. [Understanding Arbitrum 2-Dimensional Fees.](https://medium.com/offchainlabs/understanding-arbitrum-2-dimensional-fees-fd1d582596c9) -->
<!-- \[6\] DZack23. July 2022. [L1 calldata data pricing / Sequencer reimbursement, "Fee Pool" Model.](https://research.arbitrum.io/t/l1-calldata-data-pricing-sequencer-reimbursement-fee-pool-model/107)
 -->
<p><a id="ref-7">[7]</a>  <a href="https://eips.ethereum.org/EIPS/eip-1559">EIP-1559.</a></p>
<p><a id="ref-8">[8]</a>  Ethereum. <a href="https://ethereum.org/en/developers/docs/gas/#eip-1559">Gas and Fees.</a></p>
<p><a id="ref-9">[9]</a>  <a href="https://ethresear.ch/t/multidimensional-eip-1559/11651">Multi-dimensional EIP-1559.</a></p>
<p><a id="ref-10">[10]</a>  <a href="https://youtu.be/QbR4MTgnCko">Notes on multi-dimensional EIP-1559.</a></p>
<!-- \[11\] Optimism. [Bedrock Fees Dashboard.](https://dune.com/oplabspbc/optimism-bedrock-migration-impact-dashboard.) -->
<!-- \[12\] Arbitrum Nitro. [Fees Dashboard.](https://dune.com/taem/arbitrum-gas-fee)

\[13\] [EigenLayer.](https://www.eigenlayer.xyz)

\[14\] Ethereum. [Scaling.](https://ethereum.org/pt/roadmap/scaling/)
 -->
<hr />
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">2</sup>
<p>There is another <em>refund</em> component in the Aptos-Move fee statement that we ignore here.</p>
</div>
<div class="footnote-definition" id="2"><sup class="footnote-definition-label">3</sup>
<p>We may be able to have the quorum verification function in a Movement contract which would reduce the costs.</p>
</div>
<div class="footnote-definition" id="3"><sup class="footnote-definition-label">1</sup>
<p>It looks like the actual currency used to express this fee is a stable currency like USD. It can be converted to <code>$APT</code> using an oracle.</p>
</div>
<hr />
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p>Copyright and related rights waived via <a href="../LICENSE.html">CC0</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MIP/mip-42/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../../Review/primata/mip-18/MIP/mip-18/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MIP/mip-42/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../../Review/primata/mip-18/MIP/mip-18/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../elasticlunr.min.js"></script>
        <script src="../../../../mark.min.js"></script>
        <script src="../../../../searcher.js"></script>

        <script src="../../../../clipboard.min.js"></script>
        <script src="../../../../highlight.js"></script>
        <script src="../../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
