<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>MIP-58: Trusted-Relayer focused Bridge Design - MIP</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../../../../favicon.svg">
        <link rel="shortcut icon" href="../../../../favicon.png">
        <link rel="stylesheet" href="../../../../css/variables.css">
        <link rel="stylesheet" href="../../../../css/general.css">
        <link rel="stylesheet" href="../../../../css/chrome.css">
        <link rel="stylesheet" href="../../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../../../../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../../highlight.css">
        <link rel="stylesheet" href="../../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../../../../GLOSSARY.html">Glossary</a></li><li class="chapter-item expanded "><a href="../../../../index.html">Approved</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../index.html">MIPs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-1/index.html">MIP-1: ENTL (Enclave Nonce Time-lock)</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-15/index.html">MIP-15: MG (Movement Gloss)</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-39/index.html">MIP-39: MOVE Token -- HTLC-based Native Bridge Design</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MIP/mip-53/index.html">MIP-53: Conventions for Proposing Progressive L2 Models</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MDs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-1/index.html">MD-1: Minimize Risk of Compromised Bridge Key without Governance</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-3/index.html">MD-3: MCR under Network Partitions and Asynchrony</a></li><li class="chapter-item expanded "><a href="../../../../Approved/main/MD/md-15/index.html">MD-15: Movement Glossary</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MGs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Approved/main/MG/mg-39/index.html">MG-39:  MOVE Token -- Bridge Design</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">Review</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../index.html">MIPs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/mikhail/suzuka-da-migrations/MIP/mip-13/index.html">MIP-13:  Suzuka DA Migrations Format</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MIP/mip-42/index.html">MIP-15: NB-FFS Decoupled Demurrage</a></li><li class="chapter-item expanded "><a href="../../../../Review/gas-fee-calculation/MIP/mip-16/index.html">MIP-16: Calculation of gas fees </a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mip-18/MIP/mip-18/index.html">MIP-18: Stage 0 Upgradeability and Multisigs</a></li><li class="chapter-item expanded "><a href="../../../../Review/andyjsbell/unwanted-framework/MIP/mip-24/index.html">MIP-24: Removal of redundant functionality from framework</a></li><li class="chapter-item expanded "><a href="../../../../Review/andyjsbell/proxy-root/MIP/mip-25/index.html">MIP-25: Proxy Aptos Framework for Stage 0 governance</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/mip-27/MIP/mip-27/index.html">MIP-27: Contract Pipeline</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/actor-naming-conventions/MIP/mip-28/index.html">MIP-28: Naming Conventions for Movement Protocol Design</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/FFS/MIP/mip-34/index.html">MIP-34: Fast-Finality Settlement</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled/MIP/mip-40/index.html">MIP-40: NB-FFS Decoupled</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-governed-gas-pool/MIP/mip-44/index.html">MIP-44: NB-FFS Governed Gas Pool</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/security_falliblity/MIP/mip-46/index.html">MIP-46: Security and Fallibility of the Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/gas-fees-incremental-additions/MIP/mip-47/index.html">MIP-47: Improve Gas fee collection in phases</a></li><li class="chapter-item expanded "><a href="../../../../Review/0xmovses/aptos-gov-pool/MIP/mip-48/index.html">MIP-48: aptos_governance for Goverened Gas Pool</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/just-reward/MIP/mip-49/index.html">MIP-49: NB-FFS Governed Fees and Rewards</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/insured-bridge/MIP/mip-50/index.html">MIP-50: Insured Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/the-biarritz-model/MIP/mip-54/index.html">MIP-54: The Biarritz Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/the-bilbao-model/MIP/mip-55/index.html">MIP-55: The Bilbao Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter/MIP/mip-56/index.html">MIP-56: Rate-Limiter for the HTLC-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer/MIP/mip-57/index.html">MIP-57: Informer for the Operation of the HTLC-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip-58/MIP/mip-58/index.html" class="active">MIP-58: Trusted-Relayer focused Bridge Design</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip-crosschain-bridges-background/MIP/mip-60/index.html">MIP-60: Crosschain bridge architectures</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/relayer-bootstrap-and-reboot/MIP/mip-61/index.html">MIP-61: Relayer in the lock/mint bridge - Algorithm and Bootstrapping </a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/L2confirmation/MIP/mip-65/index.html">MIP-65: FFS: Fastconfirmations</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer-lockmintbridge/MIP/mip-71/index.html">MIP-71: Informer V1 for the Operation of the Lock/Mint Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/sanfran-model/MIP/mip-73/index.html">MIP-73: The SanFran Model</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter-lock-mint-bridge/MIP/mip-74/index.html">MIP-74: Rate-Limiter for the Lock/Mint-type Native Bridge</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MDs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/enclave-crash-resistant-keys/MD/md-2/index.html">MD-2: Enclave Crash-resistant Key Management</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/long-range-attacks/MD/md-5/index.html">MD-4: Long Range Attacks</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/gas-offset/MD/md-4/index.html">MD-4: MCR Offsetting Gas Costs</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/block-validation/MD/md-6/index.html">MD-6: Suzuka Block Validation</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/block-validation/MD/md-7/index.html">MD-7: Prevent Suzuka MEV Exploits and Censorship</a></li><li class="chapter-item expanded "><a href="../../../../Review/mikhail/suzuka-da-migrations/MD/md-13/index.html">MD-13: Suzuka DA Migrations Format</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/bridge-timelock-as-state/MD/md-14/index.html">MD-14: Bridge Should Use A More Secure Timelock</a></li><li class="chapter-item expanded "><a href="../../../../Review/andygolay/move-on-bitcoin/MD/md-16/index.html">MD-16: Create MOVE fungible asset on Bitcoin using runes</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/md-17/MD/md-17/index.html">MD-17: Bridge Fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/bridge-attestors/MD/md-21/index.html">MD-21: Native Bridge with Attesters</a></li><li class="chapter-item expanded "><a href="../../../../Review/andygolay/md-26/MD/md-26/index.html">MD-26: User-facing checks</a></li><li class="chapter-item expanded "><a href="../../../../Review/primata/md-30/MD/md-30/index.html">MD-30: Movement Name Service</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/provisions-for-fixed-token-supply/MD/md-38/index.html">MD-38: Provide for Fixed Token Supply when Using Native Bridge and Fast Finality Settlement (FFS)</a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/just-reward/MD/md-49/index.html">MD-49: Movement L2 Gas Fees</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/informer-lockmintbridge/MD/md-71/index.html">MD-71: Informer service for the Lock/Mint-based Native Bridge</a></li><li class="chapter-item expanded "><a href="../../../../Review/mip/rate-limiter-lock-mint-bridge/MD/md-74/index.html">MD-74: Rate-Limiter for the Lock/Mint-type Native Bridge</a></li></ol></li><li class="chapter-item expanded "><a href="../../../../index.html">MGs</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../../../../Review/mip/FFS/MG/mg-34/index.html">MG-34: </a></li><li class="chapter-item expanded "><a href="../../../../Review/l-monninger/ab-ffs-decoupled-demurrage/MG/mg-42/index.html">MG-42: demurrage token</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">MIP</h1>

                    <div class="right-buttons">
                        <a href="../../../../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        <a href="https://github.com/movementlabsxyz/MIP-Testing" title="Git repository" aria-label="Git repository">
                            <i id="git-repository-button" class="fa fa-github"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="mip-58-trusted-relayer-focused-bridge-design"><a class="header" href="#mip-58-trusted-relayer-focused-bridge-design">MIP-58: Trusted-Relayer focused Bridge Design</a></h1>
<ul>
<li><strong>Description</strong>: Proposes a bridge design that capitalizes on the trust-assumption on the relayer, reduces the number of messages, and potentially cost.</li>
<li><strong>Authors</strong>: <a href="mailto:primata@movementlabs.xyz">Primata</a></li>
<li><strong>Desiderata</strong>: <a href="../MD/md-21">MD-21</a></li>
</ul>
<h2 id="abstract"><a class="header" href="#abstract">Abstract</a></h2>
<p>This proposal advocates for replacing the current HTLC-based bridge design, which requires four transactions and introduces significant complexity, with a simpler and more efficient two-transaction mechanism. The proposed design reduces costs, enhances security, minimizes user friction, and avoids potential exploits caused by refund logic. It addresses long-standing issues such as reliance on sponsored transactions, outdated audits, and unimplemented fee mechanisms speeding the process to achieve a fully functional bridge that movement yet has been unable to complete, and lots of under issues raised and still pending.</p>
<h2 id="motivation"><a class="header" href="#motivation">Motivation</a></h2>
<p>The current bridge design poses numerous challenges, including inefficiency, cost, and user frustration:</p>
<ol>
<li><strong>Transaction Complexity</strong>: Requires four interactions:
<ul>
<li>Two by the user (initiation and finalization).</li>
<li>One by the relayer to complete the transaction.</li>
<li>One by a third party (tasked by the relayer) to finalize refunds in case of failure.</li>
<li>If any of these fails, users and the protocol face losses.</li>
</ul>
</li>
<li><strong>High Cost</strong>:
<ul>
<li>The multi-transaction setup is expensive for both users and the protocol.</li>
<li>Misestimations in fee calculations could result in significant losses.</li>
<li>Example: At 16 gwei, bridging costs $20 for 10k transactions. If fees are miscalculated by 25%, this leads to a $25k loss. At 100 gwei, the loss escalates dramatically.</li>
</ul>
</li>
<li><strong>Unfriendly User Experience</strong>:
<ul>
<li>The current design requires users to have funds on the destination chain for finalization. This increases friction and discourages adoption.</li>
<li>Sponsored transactions are essential to the current implementation but remain unimplemented, leaving users stranded without funds.</li>
</ul>
</li>
<li><strong>Security Risks</strong>:
<ul>
<li>Relayer keys are a critical point of failure. This assumption cannot be avoided.</li>
<li>Refund logic introduces vulnerabilities where attackers could exploit the rate limit and relayer downtime.</li>
<li>For instance, if the relayer fails to finalize on the initiator, a malicious actor could:
<ul>
<li>Take over the refund keys.</li>
<li>Exploit both directions of the bridge (e.g., ETH→MOVE and MOVE→ETH) repeatedly, draining funds.</li>
</ul>
</li>
</ul>
</li>
<li><strong>Maintenance Burden</strong>:
<ul>
<li>The current audit is outdated and does not reflect the significant changes made since.</li>
<li>The current design requires a complete UI/UX overhaul, adding complexity and delay.</li>
</ul>
</li>
<li><strong>Unnecessary Complexity</strong>:
<ul>
<li>HTLC-based bridges are largely abandoned in favor of simpler, more effective designs.</li>
<li>Examples like the <a href="https://github.com/Consensys/htlc-bridge">Consensys HTLC</a> bridge demonstrate the <a href="https://entethalliance.org/crosschain-bridges-overview-where-we-are-now/">pitfalls of such approaches</a>.</li>
</ul>
</li>
<li><strong>Infrastructure Simplification</strong>:
<ul>
<li>Infrastructure is still incomplete for the current HTLC bridge design and we are struggling to find sound solutions that balance UI/UX and security. For example, <a href="https://github.com/movementlabsxyz/movement/issues/838">this issue</a> regarding UX vs number of confirmations to require on the Ethereum side, is still under debate.</li>
<li>Because of the over-engineered design, infrastructure is prone to error and we might end up being damaged by the amount of infrastructure we have not built yet and has to be built for the relayer to fully function.</li>
<li>We could strip down the Relayer code and achieve a final design much more quickly.</li>
</ul>
</li>
</ol>
<p>The proposed lock/mint bridge design mitigates these issues, creating a safer, faster, and user-friendly bridge while maintaining operational reliability.</p>
<h2 id="specification"><a class="header" href="#specification">Specification</a></h2>
<p>The lock/mint bridge design focuses on minimizing complexity and maximizing security:</p>
<h3 id="protocol-description"><a class="header" href="#protocol-description">Protocol Description</a></h3>
<p>The bridge is a simpler version of the current implementation, which relies on the assumption that the Relayer Keys are not to be compromised.</p>
<p>L1 -&gt; L2</p>
<ol>
<li>User initiates a bridge transfer on L1. Contract stores a mapping of the user bridgeTransferIds for easy access. It transfers from the user MOVE amount to the contract. Transaction emits originator, recipient, amount and nonce.</li>
<li>Relayer awaits for finalization of the transaction on L1.</li>
<li>Relayer completes the bridge on L2.</li>
<li>Completion transaction verifies that the transaction is truthful by comparing the provided bridgeTransferId hash and the emitted values of originator, recipient, amount and nonce. Finally, it mints MOVE to the recipient address.</li>
<li>User is notified on the frontend that their transaction has been completed.</li>
<li>In case of a rare case of a reorg on the recipient network that leads to the transaction removal from the user perspective, the transaction can be redone and relayer multisig can handle it.</li>
</ol>
<p><img src="L1ToL2.png" alt="L1-L2" /></p>
<p>L2 -&gt; L1</p>
<ol>
<li>User initiates a bridge transfer on L2. Contract stores a mapping of the user nonce to bridge details for easy access. It transfers from the user MOVE amount to the contract and burns it. Transaction emits originator, recipient, amount and nonce.</li>
<li>Relayer awaits for finalization of the transaction on L2.</li>
<li>Relayer completes the bridge on L1.</li>
<li>Completion transaction verifies that the transaction is truthful by comparing the provided bridgeTransferId hash and the emitted values of initiator, recipient, amount and nonce. Finally, it transfers MOVE to the recipient address, which has been previously bridged from L1.</li>
<li>User is notified on the frontend that their transaction has been completed.</li>
<li>In case of a rare caase of a reorg on the recipient network that leads to the transaction removal from the user perspective, the transaction can be redone and relayer multisig can handle it.</li>
</ol>
<p><img src="L2ToL1.png" alt="L2-L1" /></p>
<h3 id="key-features"><a class="header" href="#key-features">Key Features</a></h3>
<ol>
<li>
<p><strong>Lock/Mint mechanism</strong>:</p>
<ul>
<li><strong>Initiation</strong>: User sends a transaction to initiate the bridge containing recipient and amount.</li>
<li><strong>Completion</strong>: A relayer or multi-signature group completes the transfer on the counterparty contract with the originator, recipient, amount and noce for hash verification.</li>
<li><strong>No Funds Requirement</strong>: User is not required to have funds on receiving chain and we do not have to build sponsored transactions.</li>
<li><strong>Delivery by Relayer</strong>: Because the relayer delivers the funds, there is no requirement for the user to complete the transaction on receiving chain, therefore massively simplifying the user experience and allowing a smooth onboarding on the network for bridges from L1 to L2. User only has to await for the finalization on the source chain and for the relayer to perform the completion on receiving chain. This is standard practice for every major bridge in the ecosystem.</li>
<li><strong>Less parameters</strong>: Because there is no exchange of secrets between the user and relayer, we have a substantial reduction of logic.</li>
<li><strong>Only Completable</strong>: Currently we reserve a refunder role to revert transactions. This approach is different where we guarantee delivery of funds through the same party that would guarantee funds being refunded, because bridges can ONLY be completed.</li>
</ul>
</li>
<li>
<p><strong>Consolidation of Logic</strong>:</p>
<ul>
<li>Merge lock and completion functionality on the counterparty contract. Once lock is called, funds are already in the control of the user. On the HTLC implementation, once the timelock is over and complete on initiator has not been called, both the initiator and counterparty funds are available to the user, opening up for an exploit.</li>
<li>Remove refund functionality entirely to eliminate associated exploits.</li>
</ul>
</li>
<li>
<p><strong>Parameter Validation</strong>:</p>
<ul>
<li>Ensure parameter validation on the counterparty to prevent invalid transactions.</li>
</ul>
</li>
<li>
<p><strong>Relayer Redundancy</strong>:</p>
<ul>
<li>Use two types of relayers:
<ul>
<li><strong>Automated Relayer</strong>: Operated with minimal human involvement; its private key is highly secured.</li>
<li><strong>Multi-Signature Relayer</strong>: Managed by the team to guarantee transaction completion in case of failures.</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Cost Efficiency</strong>:</p>
<ul>
<li>Minimize gas costs by reducing the number of interactions and simplifying fee calculations.</li>
</ul>
</li>
<li>
<p><strong>Enhanced Security</strong>:</p>
<ul>
<li>Avoid refund logic to close exploit windows.</li>
<li>Protect against key compromise through key isolation or known by no parties and multi-signature relayer setups.</li>
<li>There is no scenario where a bridge could lead to double-spending. It’s either completed by relayers or not.</li>
<li>User currently can loose its bridge <code>preImage</code> which could lead to them being unable to complete the bridge. By not relying on a <code>preImage</code> from the user, it minimizes issues. It is not a loss in security because the purpose of the <code>preImage</code> is solely for refunding.</li>
</ul>
</li>
<li>
<p><strong>Batch Processing for Downtime</strong>:</p>
<ul>
<li>Multi-signature relayers can process multiple pending transactions in a single batch during downtime.</li>
</ul>
</li>
<li>
<p><strong>BridgeTransferId</strong>:</p>
<ul>
<li>Continue using unique identifier to prevent double-spending and track transactions securely.</li>
</ul>
</li>
<li>
<p><strong>Bridge Fee</strong>:</p>
<ul>
<li>On the L1 to L2 bridge, do not charge fees.</li>
<li>On the L2 to L1 bridge, charge a fee estimated by admin. It’s set to the gas spent in ethereum in move. This requires an oracle and can only be implemented after oracles are live and we are able to have a maintainer that is able to set the fees on L2.</li>
<li>Bridge fee should be a estimated by being a threshold between the current cost to perform the completeBridgeTransfer transaction on L1 (aka. <code>cost</code>) + 20%. Then, we set <code>cost</code> as the <code>upperbound</code>. The <code>lowerbound</code> is the <code>cost</code> - 10%. This prevents us from updating the fee too often and guaranteeing profit on bridges. We do have to consider gas spikes, but it should be a momentarily loss compensated by the extra charged and maintained by the <code>upperbound</code> and <code>lowerbound</code>.</li>
</ul>
<pre><code>entry fun set_fee(caller: &amp;signer, fee: u64) {
   assert_is_maintainer(caller);
   borrow_global&lt;BridgeConfig&gt;(@aptos_framework).fee = fee;
}
</code></pre>
</li>
<li>
<p><strong>Best Practices</strong>:</p>
</li>
</ol>
<ul>
<li>Adopt currently used bridge designs from established designs like Arbitrum, LayerZero and Blast bridges which use a relayer to finalize the bridge.</li>
<li>User is not required to have funds on counterparty contract to finalize the bridge.</li>
</ul>
<h2 id="exploits-and-potential-losses"><a class="header" href="#exploits-and-potential-losses">Exploits and Potential Losses</a></h2>
<ol>
<li><strong>Key Compromise</strong>:
<ul>
<li>The compromise of the Relayer keys would lead to unauthorized transactions up to the rate-limit value. The protocol must absorb the losses and rotate Relayers.</li>
</ul>
</li>
<li><strong>Fee Misestimation</strong>:
<ul>
<li>Incorrect fee calculations (e.g., underestimating gas) can cause significant financial losses for the protocol.</li>
</ul>
</li>
</ol>
<h2 id="reference-implementation"><a class="header" href="#reference-implementation">Reference Implementation</a></h2>
<ol>
<li>
<p><strong>Two-Transaction Flow</strong>:</p>
<ul>
<li>User initiates the transfer.</li>
<li>Relayer or multisig completes the transfer with parameter validation.</li>
<li>Current HasuraDB built internally can provide enough infrastructure for users to know if their transaction has been completed. It does not differ from the current design in any way since user is not able to see if their transaction is in-flight. We could introduce this by notifying the user if the relayer has been ordered to complete the transaction.</li>
<li>There would be two states for user to reference, initiated or completed and those are the only two possible states. Funds can only be returned by bridging back.</li>
</ul>
<p><img src="tx-history.png" alt="Transaction History" />
Here users would be able to see if the bridge has been completed. It’s either pending or completed.</p>
</li>
<li>
<p><strong>Batch Completion</strong>:</p>
<ul>
<li>Multisig relayers process pending transactions in batches during downtime, ensuring timely resolution.</li>
</ul>
</li>
<li>
<p><strong>Contract Simplification</strong>:</p>
<ul>
<li>Combine lock and completion functionality on the counterparty contract.</li>
<li>Remove refund logic to streamline operations and improve security.</li>
<li>Cheaper transactions because of reduction of logic.</li>
<li>Consolidate Initiator and Counterparty into a single contract (this might be the most dangerous thing proposed but it has already been proposed for current implementation).</li>
</ul>
</li>
<li>
<p><strong>Rate Limiting</strong>:</p>
<ol>
<li>Single-sided rate limiting
<ul>
<li>Rate limiting should be implemented on the L1 and maps each day to a budget, for each direction. Once the budget is reached on one of the directions, no more tokens can be transferred on that direction. The bridge is financially secured by an <code>insurance fund</code> maintained by Movement Labs and the maximum amount of tokens to be transferred per day, per direction is one quarter of the <code>insurance fund</code> balance. This is meant to account for the insurance fund to be able to insure all current funds already transferred and all tokens inflight, per direction.</li>
<li>The <code>insurance fund</code> maintains the rate limit budget by adjusting its own <code>$MOVE</code> balance. It should be either the Movement Labs multisig or a new multisig 1/3 if we choose to adopt an approach that requires more direct ability by the personnel.</li>
<li>Once the rate limit budget is reached, if no issues have been observed, operators should simply wait for the next day.</li>
<li>If an issue has been observed, an operator should simply transfer to the bridge contract the sum of the exploit size, being the result of additional supply on L1, outside of the bridge address, and the additional supply on L2. This action covers both cases where tokens were extracted from the bridge contract on L1 or over-minted on L2. Movement Foundation should evaluate the amount of tokens that should be held by the <code>insurance fund</code> after the incident and transfer to it the amount to reach that amount.</li>
<li>This approach is open to exploits where the relayer key is compromised. It would enable the exploiter to freely mint on L2.</li>
</ul>
</li>
<li>Inbound rate limiting
<ul>
<li>Rate limiting should be implemented on both L1 and L2 for inbound transactions only. It maps a daily budget of inbound transactions and once it’s reached, the relayer cannot complete more transactions. The bridge is financially secured by two <code>insurance funds</code>, one on each side, maintained by Movement Labs, and the maximum amount of tokens to be transferred per day, per direction is half of each of its <code>insurance funds</code> balances. This is meant to account for all tokens already transferred and inflight, per direction.</li>
<li>The <code>insurance funds</code> maintain the rate limit budgets by adjusting its own <code>$MOVE</code> balance. They should be either Movement Labs multisigs or new multisigs 1/3 if we choose to adopt an approach that requires more direct ability by the personnel.</li>
<li>Once the rate limit budget is reached, if no issues have been observed, operators should simply wait for the next day.</li>
<li>If an issue has been observed, operators should transfer to the bridge address the exploit amount on the L1 and burn the exploit amount on the L2. Movement Foundation should evaluate the amount of tokens that should be held by the <code>insurance funds</code> and operators should receive those tokens and bridge tokens if an exploit occurred on L2.</li>
<li>This approach is more succetible to issues on the frontend because the frontend has to acknowledge rate limit budget and inflight tokens and inform users if the rate limit is about to be reached, not only if it has been reached.</li>
</ul>
</li>
</ol>
</li>
<li>
<p><strong>Bridge Fee</strong>:</p>
<ul>
<li>When bridging from L1 to L2, the protocol, through the Relayer, sponsors the gas cost on Movement. We do not need to make any modification on contracts or Relayer to support it.</li>
<li>When bridging from L2 to L1, we have a few viable solutions but it’s preferrable to highlight two.
<ol>
<li>Relayer sets a fee on L2, a global variable that can be set at any given time. Considering that block validation time on L1 is bigger than on L2, it becomes a viable approach since L2 can rapidly adjust the fee according to the current block and always charge an above gas cost fee to assure that despite hiccups, the bridge is net positive. $MOVE is deducted from the amount of tokens that are currently being bridged and transferred to a funds manager. Input of the user is on the final value of tokens that it should receive on the L1. This gives the protocol a very reliable way to estimate how much MOVE will be charged and feed to the user a precise amount of tokens.</li>
<li>Enable the Relayer to specify on the L1 completeBridgeTransfer transaction, the bridge fee per transaction. The amount is deducted from the total amount of tokens that were bridged and transferred to a funds manager. The dangerous situation is that we expect to way for over 10 minutes before the transfer can occur, and this could lead to a big disparity between the expected amout of funds and the actual amount of tokens received.</li>
</ol>
</li>
</ul>
</li>
</ol>
<p><a href="https://github.com/movementlabsxyz/movement/tree/primata/simple-native-bridge">Solidity Implementation</a></p>
<p><a href="https://github.com/movementlabsxyz/aptos-core/tree/andygolay/simplified-bridge">Move Implementation</a></p>
<h2 id="verification"><a class="header" href="#verification">Verification</a></h2>
<ol>
<li>
<p><strong>Correctness</strong>:</p>
<ul>
<li>Simulate multiple transaction scenarios to ensure robustness.</li>
<li>Test edge cases, including relayer downtime and batch processing.</li>
</ul>
</li>
<li>
<p><strong>Security Implications</strong>:</p>
<ul>
<li>Conduct audits focused on the simplified design.</li>
<li>Implement rate-limiting safeguards and validate parameters in contracts.</li>
</ul>
</li>
<li>
<p><strong>Performance Impacts</strong>:</p>
<ul>
<li>Benchmark gas costs and transaction throughput.</li>
</ul>
</li>
<li>
<p><strong>Validation Procedures</strong>:</p>
<ul>
<li>Perform an audit and thorough testing, alongside an open invite to the community to verify the bridge.</li>
<li>Seek community feedback and incorporate suggestions.</li>
</ul>
</li>
</ol>
<h2 id="appendix"><a class="header" href="#appendix">Appendix</a></h2>
<h3 id="a1-related-issues"><a class="header" href="#a1-related-issues">A1: Related Issues</a></h3>
<ul>
<li><a href="https://github.com/movementlabsxyz/movement/issues/838">Movement Issue #838</a></li>
<li><a href="https://github.com/movementlabsxyz/movement/issues/842">Movement Issue #842</a></li>
</ul>
<h3 id="a2-gas-cost-comparison"><a class="header" href="#a2-gas-cost-comparison">A2: Gas Cost Comparison</a></h3>
<ul>
<li><strong>Current Design</strong>: ~400k gas per bridge round trip.</li>
<li><strong>Simplified Design</strong>: ~200k gas per bridge round trip.</li>
</ul>
<h3 id="a3-referenced-designs"><a class="header" href="#a3-referenced-designs">A3: Referenced Designs</a></h3>
<ul>
<li><a href="https://bridge.arbitrum.io/?destinationChain=arbitrum-one&amp;sourceChain=ethereum">Arbitrum Bridge</a></li>
<li><a href="https://docs.blast.io/building/bridges/mainnet">Blast Bridge</a></li>
</ul>
<hr />
<h2 id="copyright"><a class="header" href="#copyright">Copyright</a></h2>
<p>Copyright and related rights waived via <a href="../LICENSE.html">CC0</a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../../../../Review/mip/informer/MIP/mip-57/index.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../../../../Review/mip-crosschain-bridges-background/MIP/mip-60/index.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../../../../Review/mip/informer/MIP/mip-57/index.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../../../../Review/mip-crosschain-bridges-background/MIP/mip-60/index.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../../../../elasticlunr.min.js"></script>
        <script src="../../../../mark.min.js"></script>
        <script src="../../../../searcher.js"></script>

        <script src="../../../../clipboard.min.js"></script>
        <script src="../../../../highlight.js"></script>
        <script src="../../../../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
